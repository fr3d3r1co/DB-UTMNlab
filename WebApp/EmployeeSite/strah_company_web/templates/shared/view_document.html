{% extends "base.html" %}

{% block title %}Документ: {{ document.file_name }}{% endblock %}

{% block content %}
<div class="row">
    <div class="col-12">
        <div class="card">
            <div class="card-header d-flex justify-content-between align-items-center">
                <h5 class="mb-0">Информация о документе</h5>
                <a href="{{ url_for('documents_list') }}" class="btn btn-outline-dark btn-sm">
                    ← Назад к документам
                </a>
            </div>
            <div class="card-body">
                <div class="row">
                    <div class="col-md-6">
                        <table class="table table-sm">
                            <tr>
                                <th width="40%">Название файла:</th>
                                <td>{{ document.file_name }}</td>
                            </tr>
                            <tr>
                                <th>Описание:</th>
                                <td>{{ document.description or '—' }}</td>
                            </tr>
                            <tr>
                                <th>Уровень доступа:</th>
                                <td>
                                    <span class="badge 
                                        {% if document.confidentiality_level == 0 %}bg-success
                                        {% elif document.confidentiality_level == 1 %}bg-warning
                                        {% else %}bg-danger{% endif %}">
                                        {% if document.confidentiality_level == 0 %}Публичный
                                        {% elif document.confidentiality_level == 1 %}ДСП
                                        {% else %}Только начальники{% endif %}
                                    </span>
                                </td>
                            </tr>
                            <tr>
                                <th>Размер файла:</th>
                                <td>
                                    {% if document.file_size %}
                                        {{ "%.1f"|format(document.file_size / 1024 / 1024) }} МБ
                                    {% else %}
                                        —
                                    {% endif %}
                                </td>
                            </tr>
                        </table>
                    </div>
                    <div class="col-md-6">
                        <table class="table table-sm">
                            <tr>
                                <th width="40%">Отдел:</th>
                                <td>{{ document.department_name }}</td>
                            </tr>
                            <tr>
                                <th>Создал:</th>
                                <td>{{ document.created_by_name }}</td>
                            </tr>
                            <tr>
                                <th>Дата создания:</th>
                                <td>{{ document.created_at.strftime('%d.%m.%Y %H:%M') }}</td>
                            </tr>
                            {% if document.policy_id %}
                            <tr>
                                <th>Привязан к полису:</th>
                                <td>№ {{ document.policy_id }}</td>
                            </tr>
                            {% endif %}
                        </table>
                    </div>
                </div>
                
                <div class="mt-4">
                    <a href="{{ url_for('download_document', document_id=document.document_id) }}" 
                       class="btn btn-primary">
                        Скачать документ
                    </a>
                    
                    {% if user_role in ['department_manager', 'hr_manager', 'company_director', 'db_admin'] %}
                    <a href="{{ url_for('edit_document', document_id=document.document_id) }}" 
                       class="btn btn-outline-primary">
                        Редактировать
                    </a>
                    {% endif %}
                </div>
            </div>
        </div>
    </div>
</div>
{% endblock %}